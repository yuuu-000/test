<!DOCTYPE html><html lang="ja"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p&display=swap" rel="stylesheet"><title>(仮)</title><style>html,body{width:100%;height:100%;padding:0;margin:0;background-color:#151617;-webkit-tap-highlight-color:transparent;animation:access .6s ease}@keyframes access{from{opacity:.4;transform:translate(-300px,150px)}to{opacity:1;transform:translate(0,0)}}::selection{background-color:#fd5;color:#000}::-webkit-scrollbar{width:5px;height:5px}::-webkit-scrollbar-thumb{background-color:#eee;border-radius:150px}h1:hover,#savedTimeBox:hover,#table:hover,label:hover,#upload:hover,#contact:hover{color:#fd5;text-shadow:0 0 10px #ffdd55ff}#textInput:focus,#textInput:hover,#howto:hover{outline:none;border-color:#fd5;box-shadow:0 0 30px 2px #ffdd5555}h1{position:relative;left:50%;transform:translateX(-52%);width:fit-content;font-size:23px;transition:color 1s ease,text-shadow 1s ease}#bodyBox{width:100%;height:100%;color:#eee;display:flex;flex-direction:column;position:fixed;font-family:"M PLUS 1p";font-weight:500;overflow:auto}#Container{position:relative;left:50%;transform:translateX(-50%);padding:0 20px;max-width:760px;flex:1}#pipactive{width:100%;height:calc(max(calc(100vh/2),280px) + 181px + 29px);border:solid 2px #ddd;border-radius:49px;display:none;cursor:crosshair;transition:border-color 1s ease,box-shadow 1s ease}#pipactive:hover{border-color:#fd5;box-shadow:0 0 30px 2px #ffdd5555}#pipactive span{font-size:20px;display:inline-block;position:relative;top:50%;left:50%;transform:translate(-50%,-50%)}#pipBox{margin-bottom:50px}#textareaBox{display:flex;justify-content:center}#textInput{width:calc(100% - 6px);height:max(calc(100vh/2),280px);background-color:#303230;color:#eee;border-radius:35px;border:solid 1.5px #eee;padding:15px;transition:border-color 1s ease,box-shadow 1s ease}#savedTimeBox{position:relative;left:50%;transform:translateX(-52%);width:fit-content;font-size:13px;color:#ccc;transition:color 1s ease,text-shadow 1s ease}#stats{margin:20px 0;line-height:1.5}#table{position:relative;left:50%;transform:translateX(-52%);width:60%;min-width:210px;color:#eee;transition:color 1s ease,text-shadow 1s ease}.td1{width:80%}.td2{width:20%;text-align:right;text-decoration:underline}button{font-size:14px;margin:7px 13px 0 0;width:110px;height:30px;background-color:transparent;color:#eee;border:solid 1px #eee;border-radius:20px;outline:none;box-shadow:none;cursor:pointer;transition:box-shadow .3s ease,border-radius .3s ease}button:hover{box-shadow:0 0 20px 3px #ffdd5599;border-color:#fd5;border-radius:9px}label{cursor:pointer;width:fit-content;display:flex;align-items:center;transition:color .3s ease,text-shadow .3s ease}#howto{margin-top:50px;padding:20px;border:solid 1.5px #eee;border-radius:35px;transition:border-color 1s ease,box-shadow 1s ease}#howtoTitle{font-size:23px;font-weight:900}ul,li{font-size:15px;padding-bottom:8px;margin:5px 0 -4px -8px}#contact{font-size:13.5px;color:#eee;text-align:center;margin:auto;padding:60px 0 25px 0;line-height:1.8;transition:color 1s ease,text-shadow 1s ease}.contact::before{content:"";background-image:url(https://jimajimax.github.io/text-counter/img/x-white.svg);display:inline-flex;width:8.5px;height:8.5px;background-size:contain;background-repeat:no-repeat;margin-left:5px}.contact{color:#7df;margin-right:5px}.contact:hover,.contact:visited:hover{color:#fd5}.contact:visited{color:#e6f}</style><div id="bodyBox" data-nosnippet><div id="Container"><h1>文字数カウントツール</h1><div id="pipactive" title="クリックでPiPを閉じる"><span>Picture in Picture Mode Is Active Now</span></div><div id="pipBox"><div id="textContainer"><div id="textareaBox"><textarea id="textInput" placeholder="ここにテキストを入力..."></textarea></div><div id="savedTimeBox"></div><div id="stats"><table id="table"><tr><td class="td1">文字数 (スペース含):<td class="td2"><span id="charWithSpaces">0</span><tr><td class="td1">文字数 (スペース除):<td class="td2"><span id="charWithoutSpaces">0</span><tr><td class="td1">行数:<td class="td2"><span id="lineCount">0</span><tr><td class="td1">段落数:<td class="td2"><span id="paragraphCount">0</span><tr><td class="td1">原稿用紙 (400字詰):<td class="td2"><span id="pageCount">0</span>枚</table></div></div></div><label><button id="pipBtn">PiP</button><span id="pipState">Picture-in-Pictureで表示</span></label> <label><button id="clear">クリア</button><span id="clearState">クリアする</span></label> <label><button id="share">共有</button><span id="shareState">入力内容を共有する</span></label> <label><button id="copy">コピー</button><span id="copyState">クリップボードにコピー</span></label> <label><button id="paste">ペースト</button><span id="pasteState">クリップボードからペースト</span></label> <label><button id="download">保存</button><span id="downloadState">入力内容をデバイスに新規保存</span></label> <label id="editLabel"><button id="edit">編集</button><span id="editState">デバイスのファイルを編集、上書き</span></label> <label id="editSaveLabel" style="display:none"><button id="editSave">上書き保存</button><span id="editSaveState">内容をデバイスに上書き保存</span></label><input id="upload" type="file" accept=".txt, .html, .css, .js, .json, .md, .xml, .csv" style="display:none"><div id="howto"> <span id="howtoTitle">使い方:</span><ul><li>カウントしたい内容を入力するだけです<li>枠の右下をドラッグすると大きさを変更できます<br>(スマホ、タブレットの場合判定がシビア)<li>PiPは常に最前面で表示できます<li>デバイスにファイルを新しく保存できます<li>デバイスのファイルを選択し編集、上書きできます<li><strong>入力内容は一切外部送信しません</strong>がブラウザに保存するため機密情報などはお気をつけ下さい<li>520万文字目安で保存が機能しなくなる場合があります<li>原稿用紙は行末の 」 、 。 は考慮していません<li>自動保存されるのでToDoリスト、メモ機能にもなります</ul></div></div><div id="contact">バク、不具合、要望などは<a class="contact" href="https://x.com/messages/compose?recipient_id=1817905403663171584" target="_blank" title="X | Twitter">こちら</a>までお願いします <br>Copyright © 2024-2025 jimajimax All Rights Reserved.</div></div><script>const t=document.getElementById("textInput"),e=document.getElementById("textContainer"),n=document.getElementById("charWithSpaces"),o=document.getElementById("charWithoutSpaces"),l=document.getElementById("lineCount"),c=document.getElementById("paragraphCount"),i=document.getElementById("pageCount"),a=document.getElementById("pipactive"),s=document.getElementById("pipState"),r=document.getElementById("savedTimeBox"),d=document.getElementById("clear"),m=document.getElementById("clearState"),u=document.getElementById("share"),y=document.getElementById("shareState"),p=document.getElementById("copy"),x=document.getElementById("copyState"),g=document.getElementById("paste"),h=document.getElementById("pasteState"),v=document.getElementById("download"),C=document.getElementById("downloadState"),E=document.getElementById("edit"),f=document.getElementById("editState"),w=document.getElementById("editLabel"),S=document.getElementById("editSave"),I=document.getElementById("editSaveState"),B=document.getElementById("editSaveLabel"),k=document.getElementById("upload");let T=!0;function b(){const e=new Intl.Segmenter("ja-JP",{granularity:"grapheme"}),a=t.value;n.textContent=Array.from(e.segment(a.replace(/\n/g,""))).length,o.textContent=Array.from(e.segment(a.replace(/\s/g,""))).length,l.textContent=a.split("\n").length,c.textContent=a.trim().split(/\n\s*\n|(?<=\n)\s+/).filter(t=>""!==t.trim()).length,i.textContent=Math.ceil(Array.from(e.segment(a.replace(/\n/g,""))).length/400),localStorage.setItem("text-counter_text",a),0===a.length&&setTimeout(()=>{localStorage.removeItem("text-counter_text"),localStorage.removeItem("text-counter_savedTime"),r.textContent="保存時刻: (保存していません)",l.textContent="0"},1)}function L(){const t=new Date,e=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")+"  "+String(t.getHours()).padStart(2,"0")+":"+String(t.getMinutes()).padStart(2,"0")+":"+String(t.getSeconds()).padStart(2,"0");r.textContent="保存時刻: "+e,localStorage.setItem("text-counter_savedTime",e)}t.addEventListener("input",()=>{b(),L()}),window.addEventListener("load",()=>{const e=localStorage.getItem("text-counter_savedTime");r.textContent=null==e?"保存時刻: (保存していません)":"保存時刻: "+e;const n=localStorage.getItem("text-counter_text");n&&(t.value=n,b())});const P=document.getElementById("pipBtn");let j=null,F=null;if("documentPictureInPicture"in window){async function A(){const n=document.querySelector("#textContainer");F=n.parentNode,j=await documentPictureInPicture.requestWindow({width:300,height:430}),[...document.styleSheets].forEach(t=>{try{const e=[...t.cssRules].map(t=>t.cssText).join(""),n=document.createElement("style");n.textContent=e,j.document.head.appendChild(n)}catch(e){const n=document.createElement("link");n.rel="stylesheet",n.type=t.type,n.media=t.media,n.href=t.href,j.document.head.appendChild(n)}}),j.document.body.append(n),a.style.display="block",document.title="字数カウント | PiP",s.textContent="Picture-in-Pictureを閉じる",t.style.height="140px",e.style.margin="30px",j.addEventListener("unload",W.bind(j),{once:!0})}function W(){if(this!==j)return;const n=j.document.querySelector("#textContainer");F.append(n),j.close(),a.style.display="none",document.title="文字数カウントツール",s.textContent="Picture-in-Pictureで表示",t.style.height=Math.max(innerHeight/2,280)+"px",t.style.width=innerWidth-6+"px",e.style.margin="0",j=null,F=null}P.addEventListener("click",()=>{j?W.bind(j)():A()}),a.addEventListener("click",()=>{W.bind(j)()})}else P.addEventListener("click",()=>{alert("Sorry...🙏\nこのデバイスまたはこの環境ではPiP表示にできないみたい😭"),s.innerHTML="<strike>Picture-in-Pictureで表示</strike>",s.style.fontStyle="italic"});d.addEventListener("click",()=>{if(!t.value.trim())return m.style.color="#fd5",m.textContent="クリアしました",void setTimeout(()=>{m.style.color="",m.textContent="クリアする"},1500);confirm("クリアしますか？\n保存も全て削除されます")?(t.value="",b(),m.style.color="#fd5",m.textContent="クリアしました",setTimeout(()=>{m.style.color="",m.textContent="クリアする"},1500)):(m.style.color="#fd5",m.textContent="キャンセルしました",setTimeout(()=>{m.style.color="",m.textContent="クリアする"},1500))}),u.addEventListener("click",async()=>{if(navigator.share){if(!t.value.trim())return void alert("共有する内容を入力してください");try{await navigator.share({title:"入力内容を共有",text:t.value})}catch(t){"AbortError"===t.name&&(y.style.color="#fd5",y.textContent="キャンセルしました",setTimeout(()=>{y.style.color="",y.textContent="入力内容を共有する"},1500))}}else alert("共有機能はこのブラウザまたはこの環境で使えないようです...")}),p.addEventListener("click",()=>{const e=t.value;t.value.trim()?navigator.clipboard.writeText(e).then(()=>{x.textContent="コピーしました",x.style.color="#fd5",setTimeout(()=>{x.style.color="",x.textContent="クリップボードにコピー"},1500)}).catch(()=>{x.textContent="コピーできませんでした...",x.style.color="#fd5",setTimeout(()=>{x.style.color="",x.textContent="クリップボードにコピー"},1500)}):alert("コピーする内容を入力してください")}),g.addEventListener("click",()=>{navigator.clipboard.readText().then(e=>{""!=e.trim()?(t.value=e,b(),L(),h.textContent="ペーストしました",h.style.color="#fd5",setTimeout(()=>{h.style.color="",h.textContent="クリップボードからペースト"},1500)):alert("ペーストする内容がありません")}).catch(()=>{h.textContent="ペーストできませんでした...\n手動でペーストお願いします",h.style.color="#fd5",setTimeout(()=>{h.style.color="",h.textContent="クリップボードからペースト"},1500)})}),v.addEventListener("click",async()=>{const e=t.value;let n=prompt("ファイル名と拡張子を入力してください\n(.txt .html .css .js .json .md .xml .csvなど)");if(null===n)return C.textContent="キャンセルしました",C.style.color="#fd5",void setTimeout(()=>{C.style.color="",C.textContent="入力内容をデバイスに新規保存"},1500);if(""===n&&(n="untitled.txt"),"showSaveFilePicker"in window){async function o(){try{const t=await window.showSaveFilePicker({suggestedName:n,types:[{description:"Text Files (.txt)",accept:{"text/plain":[".txt"]}},{description:"HTML Files (.html, .htm)",accept:{"text/html":[".html",".htm"]}},{description:"CSS Files (.css)",accept:{"text/css":[".css"]}},{description:"JavaScript Files (.js)",accept:{"application/javascript":[".js"]}},{description:"JSON Files (.json)",accept:{"application/json":[".json"]}},{description:"Markdown Files (.md)",accept:{"text/markdown":[".md"]}},{description:"XML Files (.xml)",accept:{"application/xml":[".xml"]}},{description:"CSV Files (.csv)",accept:{"text/csv":[".csv"]}}]}),o=await t.createWritable();await o.write(e),await o.close(),C.textContent="保存しました",C.style.color="#fd5",B.style.display="none",w.style.display="block",setTimeout(()=>{C.style.color="",C.textContent="入力内容をデバイスに新規保存"},1500)}catch(t){"AbortError"===t.name?(C.style.color="#fd5",C.textContent="キャンセルしました",setTimeout(()=>{C.style.color="",C.textContent="入力内容をデバイスに新規保存"},1500)):(C.textContent="保存できませんでした...",C.style.color="#fd5",B.style.display="none",w.style.display="block",setTimeout(()=>{C.style.color="",C.textContent="入力内容をデバイスに新規保存"},1500))}}o()}else{const l=new Blob([e]),c=document.createElement("a");c.href=URL.createObjectURL(l),c.download=n,c.click()}});let M=null;E.addEventListener("click",async()=>{if("showOpenFilePicker"in window)try{const[e]=await window.showOpenFilePicker({multiple:!1,types:[{description:"Files (.txt, .html, .htm, .css, .js, .json, .md, .xml, .csv)",accept:{"text/plain":[".txt"],"text/html":[".html",".htm"],"text/css":[".css"],"application/javascript":[".js"],"application/json":[".json"],"text/markdown":[".md"],"application/xml":[".xml"],"text/csv":[".csv"]}}]});M=e;const n=await M.getFile(),o=await n.text();t.value=o,b(),L(),B.style.display="block",w.style.display="none"}catch(t){"AbortError"===t.name?(f.style.color="#fd5",f.textContent="キャンセルしました",setTimeout(()=>{f.style.color="",f.textContent="デバイスのファイルを編集、上書き"},1500)):(f.textContent="選択できませんでした...",f.style.color="#fd5",setTimeout(()=>{f.style.color="",f.textContent="デバイスのファイルを編集、上書き"},1500))}else T&&(alert("編集機能はこのブラウザまたはこの環境で使えないようです...\nブラウザを変えてお試しください\nこの環境ではファイルの閲覧のみ可能です"),T=!1),k.click(),f.innerHTML="<strike style='font-style: italic;'>デバイスのファイルを編集、上書き</strike><br>デバイスのファイルを閲覧",E.textContent="閲覧"}),k.addEventListener("change",e=>{L(),function(e){const n=e.target.files[0],o=new FileReader;o.onload=e=>{t.value=e.target.result,b()},o.readAsText(n)}(e)}),S.addEventListener("click",async()=>{if(!M)return;if(confirm("上書き保存しますか？\n編集内容がファイルに上書きされて保存されます\n新規保存したい場合は上の「保存」ボタンから"))try{const e=await M.createWritable(),n=t.value;await e.write(n),await e.close(),B.style.display="none",w.style.display="block",f.textContent="保存しました",f.style.color="#fd5",setTimeout(()=>{f.style.color="",f.textContent="デバイスのファイルを編集、上書き"},1500)}catch(t){I.textContent="保存できませんでした...",I.style.color="#fd5",setTimeout(()=>{B.style.display="none",w.style.display="block",I.style.color="",I.textContent="内容をデバイスに上書き保存"},1500)}});</script>
